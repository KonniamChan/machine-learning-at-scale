{"paragraphs":[{"text":"%pyspark\nfrom __future__ import division\nimport ast\nimport json\nimport numpy as np\nimport boto3","dateUpdated":"Apr 17, 2016 11:07:05 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690967_-1626928739","id":"20160417-173450_1931097236","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58","dateFinished":"Apr 17, 2016 11:08:06 PM","dateStarted":"Apr 17, 2016 11:07:05 PM","focus":true},{"text":"%sh\npwd","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690971_-1628467735","id":"20160417-173450_674947246","result":{"code":"SUCCESS","type":"TEXT","msg":"/var/lib/zeppelin\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"text":"%md\n### 13.1 Test EMR","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690971_-1628467735","id":"20160417-173450_1393023271","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>13.1 Test EMR</h3>\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:60"},{"text":"%pyspark\nfrom __future__ import division\ndef format_graph(data):\n    '''Format graph into a form that can be used.'''\n    # Parse input\n    node, stripe = data.split('\\t')\n    neighbor_list = ast.literal_eval(stripe).keys()\n    neighbor_list = map(int, neighbor_list)\n    # Output current node with adjacency list, with neighbors and [] (to account for dangling nodes)\n    result = [(int(node), neighbor_list)] + zip(neighbor_list, [[]] * len(neighbor_list))\n    return result\n\ndef format_indices(data):\n    '''Parse indices file.'''\n    field, index = data.split('\\t')[0:2]\n    return (int(index), field)\n\ndef pagerank_mapper(line):\n    '''Distribute pagerank mass to outlinks.'''\n    node, (adjacency_list, page_rank) = line    \n    # Only distribute mass if node has outlinks\n    if adjacency_list:\n        n_outlinks = len(adjacency_list)\n        return [(node, 0)] + zip(adjacency_list, [page_rank / n_outlinks] * n_outlinks)\n    else:\n        return [(node, 0)]","dateUpdated":"Apr 17, 2016 11:08:22 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690971_-1628467735","id":"20160417-173450_1991449242","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:61","dateFinished":"Apr 17, 2016 11:08:22 PM","dateStarted":"Apr 17, 2016 11:08:22 PM","focus":true},{"text":"%pyspark\n# Main Spark program\nfrom __future__ import division\ndef page_rank_emr(output_path, num_iterations=10, num_take=11):\n    # Parameters that should be broadcasted    \n    N = links.count()\n    N_broadcast = sc.broadcast(N)\n    d = 0.85\n    d_broadcast = sc.broadcast(d)\n    # Initialize pageranks to 1 / total_nodes\n    ranks = links.mapValues(lambda x: 1 / N_broadcast.value)\n        \n    # Run PageRank for fixed number of iterations\n    for i in range(num_iterations):\n        links_joined = links.join(ranks)\n        # Compute missing mass \n        missing_mass = links_joined.filter(lambda x: not x[1][0]).map(lambda x: x[1][1]).reduce(lambda x,y: x+y)\n        missing_mass_broadcast = sc.broadcast(missing_mass)\n        # Compute pagerank (last step distributes the missing mass)\n        ranks = (links_joined.flatMap(pagerank_mapper)\n                    .reduceByKey(lambda x,y: x+y)\n                    .mapValues(lambda x: (1 - d_broadcast.value) * (1 / N_broadcast.value) +\n                            d_broadcast.value * (missing_mass_broadcast.value / N_broadcast.value + x)) )\n        \n    # Join with indices\n    results = ranks.join(indices).takeOrdered(num_take, key=lambda x: -x[1][0])\n    # Save results in S3\n    s3 = boto3.resource('s3')\n    s3.Object('konniamchan-w261', output_path).put(Body=json.dumps(results))","dateUpdated":"Apr 17, 2016 11:08:26 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690971_-1628467735","id":"20160417-173450_1674918775","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62","dateFinished":"Apr 17, 2016 11:08:26 PM","dateStarted":"Apr 17, 2016 11:08:26 PM","focus":true},{"text":"%pyspark\n# Initialize graph structure, partition and cache\nlinks = (sc.textFile(\"s3://konniamchan-w261/PageRank-test_indexed.txt\")\n        .flatMap(format_graph)\n        .reduceByKey(lambda x,y: max(x,y))\n        .partitionBy(5).cache() )\n# Indices RDD\nindices = sc.textFile(\"s3://konniamchan-w261/PageRank-test_indices.txt\").map(format_indices)","dateUpdated":"Apr 17, 2016 11:09:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690971_-1628467735","id":"20160417-173450_471177267","dateCreated":"Apr 17, 2016 5:34:50 PM","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:63","dateFinished":"Apr 17, 2016 11:08:34 PM","dateStarted":"Apr 17, 2016 11:08:32 PM","focus":true},{"text":"%pyspark\nprint links.collect()","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690972_-1630391479","id":"20160417-173450_1907795063","result":{"code":"SUCCESS","type":"TEXT","msg":"[(10, [5]), (5, [2, 4, 6]), (6, [2, 5]), (1, []), (11, [5]), (2, [3]), (7, [2, 5]), (8, [2, 5]), (3, [2]), (4, [1, 2]), (9, [2, 5])]\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:64"},{"text":"%pyspark\npage_rank_emr(\"emr_results_test.txt\", num_iterations=50, num_take=11)","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690972_-1630391479","id":"20160417-173450_532616977","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65"},{"text":"%sh\naws s3 cp s3://konniamchan-w261/emr_results_test.txt -","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690972_-1630391479","id":"20160417-173450_1434159378","result":{"code":"SUCCESS","type":"TEXT","msg":"[[2, [0.38436978095287694, \"B\"]], [3, [0.3429414533690358, \"C\"]], [5, [0.08088569323450434, \"E\"]], [4, [0.039087092099970126, \"D\"]], [6, [0.039087092099970126, \"F\"]], [1, [0.032781493159347676, \"A\"]], [7, [0.016169479016858935, \"G\"]], [8, [0.016169479016858935, \"H\"]], [9, [0.016169479016858935, \"I\"]], [10, [0.016169479016858935, \"J\"]], [11, [0.016169479016858935, \"K\"]]]"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:66"},{"text":"%md\n### 13.2 Wiki EMR","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690972_-1630391479","id":"20160417-173450_1704941454","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>13.2 Wiki EMR</h3>\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:67"},{"text":"%md\n#### 13.2: Wiki 10 iterations","dateUpdated":"Apr 17, 2016 11:12:38 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690972_-1630391479","id":"20160417-173450_558813782","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>13.2: Wiki 10 iterations</h4>\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:68","dateFinished":"Apr 17, 2016 11:12:36 PM","dateStarted":"Apr 17, 2016 11:12:34 PM","focus":true},{"text":"%pyspark\n# Initialize graph structure, partition and cache\n## 6 machines (r3.xlarge) with 30GB ram, 4 CPU cores each. Use ~3 tasks per core.\nlinks = (sc.textFile(\"s3://ucb-mids-mls-networks/wikipedia/all-pages-indexed-out.txt\")\n        .flatMap(format_graph)\n        .reduceByKey(lambda x,y: max(x,y))\n        .partitionBy(80).cache() )\n# Indices RDD\nindices = sc.textFile(\"s3://ucb-mids-mls-networks/wikipedia/indices.txt\").map(format_indices)","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690972_-1630391479","id":"20160417-173450_1177439985","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69"},{"text":"%pyspark\npage_rank_emr(\"emr_results_wiki_10iter_r3.txt\", num_iterations=10, num_take=100)","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690972_-1630391479","id":"20160417-173450_1335127103","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70"},{"text":"%sh\naws s3 cp s3://konniamchan-w261/emr_results_wiki_10iter.txt -","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690972_-1630391479","id":"20160417-173450_1344827748","result":{"code":"SUCCESS","type":"TEXT","msg":"[[13455888, [0.0014614491944277216, \"United States\"]], [1184351, [0.0006663317376700838, \"Animal\"]], [4695850, [0.0006398051876322704, \"France\"]], [5051368, [0.0005748538827018043, \"Germany\"]], [1384888, [0.00045030471434007765, \"Arthropod\"]], [2437837, [0.0004466009910450099, \"Canada\"]], [6113490, [0.00044481824807733323, \"Insect\"]], [7902219, [0.0004442037346546706, \"List of sovereign states\"]], [13425865, [0.00043299524497938637, \"United Kingdom\"]], [6076759, [0.0004278853361860982, \"India\"]], [4196067, [0.0004232759549600291, \"England\"]], [6172466, [0.0003981702959210551, \"Iran\"]], [14112583, [0.0003854336708563803, \"World War II\"]], [10390714, [0.0003631670660921836, \"Poland\"]], [15164193, [0.0003438311076770917, \"village\"]], [3191491, [0.00033834786526413624, \"Countries of the world\"]], [6416278, [0.000329352462699899, \"Japan\"]], [6237129, [0.00032896996560557177, \"Italy\"]], [7835160, [0.0003263207199079882, \"List of countries\"]], [1516699, [0.000325075888196799, \"Australia\"]], [13725487, [0.0003131434418438649, \"Voivodeships of Poland\"]], [9276255, [0.000309594124287149, \"National Register of Historic Places\"]], [7576704, [0.0003080954690220897, \"Lepidoptera\"]], [10469541, [0.0003035425666484637, \"Powiat\"]], [5154210, [0.0002979533522493566, \"Gmina\"]], [12836211, [0.00028579029430041955, \"The New York Times\"]], [7990491, [0.00028347554326391215, \"London\"]], [4198751, [0.0002690621118592138, \"English language\"]], [2797855, [0.0002640132750817192, \"China\"]], [11253108, [0.0002610656557793587, \"Russia\"]], [9386580, [0.00025755868485237676, \"New York City\"]], [3603527, [0.0002550899371244907, \"Departments of France\"]], [12074312, [0.0002510430114147229, \"Spain\"]], [3069099, [0.00024879018338059395, \"Communes of France\"]], [14881689, [0.0002454573288873731, \"moth\"]], [2155467, [0.0002448490318795732, \"Brazil\"]], [1441065, [0.0002387244427835649, \"Association football\"]], [14503460, [0.00023335074721647723, \"association football\"]], [2396749, [0.00022060503334466865, \"California\"]], [3191268, [0.00021509725581593032, \"Counties of Iran\"]], [10566120, [0.00021468682893424285, \"Provinces of Iran\"]], [2614581, [0.00021137909658932064, \"Central European Time\"]], [11147327, [0.00021132415996555264, \"Romania\"]], [1637982, [0.00020715963507030141, \"Bakhsh\"]], [12430985, [0.0002033811726949073, \"Sweden\"]], [11245362, [0.00020262323397771047, \"Rural Districts of Iran\"]], [9355455, [0.00019701920176544896, \"Netherlands\"]], [10527224, [0.00019142274075505437, \"Private Use Areas\"]], [14112408, [0.0001907438925660675, \"World War I\"]], [2614578, [0.0001881834363143592, \"Central European Summer Time\"]], [9391762, [0.00018809311932057113, \"New York\"]], [8697871, [0.0001871031700351699, \"Mexico\"]], [6172167, [0.00018685330251047997, \"Iran Standard Time\"]], [981395, [0.00018540138487871052, \"AllMusic\"]], [6171937, [0.00017885001540046946, \"Iran Daylight Time\"]], [5490435, [0.00017834740120609773, \"Hangul\"]], [11582765, [0.00017325786785650138, \"Scotland\"]], [14725161, [0.0001695498115358333, \"gene\"]], [12067030, [0.00016767695232738341, \"Soviet Union\"]], [9562547, [0.00016731685715946142, \"Norway\"]], [994890, [0.00016548126936235302, \"Allmusic\"]], [9997298, [0.00016067308338894786, \"Paris\"]], [9394907, [0.00016052821856873722, \"New Zealand\"]], [13280859, [0.0001590426968719424, \"Turkey\"]], [10345830, [0.0001577688615334761, \"Plant\"]], [4978429, [0.00015530367289745363, \"Geographic Names Information System\"]], [12447593, [0.00015495000507777585, \"Switzerland\"]], [8019937, [0.0001532279721899368, \"Los Angeles\"]], [11148415, [0.00014889113579828506, \"Romanize\"]], [13432150, [0.0001478810455008167, \"United States Census Bureau\"]], [4344962, [0.00014712672459315861, \"Europe\"]], [1175360, [0.0001419289786524117, \"Angiosperms\"]], [12038331, [0.00014131286755917678, \"South Africa\"]], [14565507, [0.00013909604113011736, \"census\"]], [4624519, [0.00013781320407894396, \"Flowering plant\"]], [1523975, [0.00013627013408617082, \"Austria\"]], [14981725, [0.00013494958520459972, \"protein\"]], [13328060, [0.0001347418579860688, \"U.S. state\"]], [1332806, [0.00013073867122817345, \"Argentina\"]], [10399499, [0.00013023139425370035, \"Political divisions of the United States\"]], [14963657, [0.00013006969330777438, \"population density\"]], [2578813, [0.00012834313003629952, \"Catholic Church\"]], [2826544, [0.00012828888427112207, \"Chordate\"]], [1575979, [0.0001272377417048256, \"BBC\"]], [1813634, [0.00012713810217995317, \"Belgium\"]], [2778099, [0.00012404627525294552, \"Chicago\"]], [13853369, [0.0001208387713797924, \"Washington, D.C.\"]], [9924814, [0.00012028369797645047, \"Pakistan\"]], [4568647, [0.00011582953102628542, \"Finland\"]], [12785678, [0.00011443369324765707, \"The Guardian\"]], [7467127, [0.00011442817413910542, \"Latin\"]], [9742161, [0.00011425740364750198, \"Ontario\"]], [3328327, [0.00011368488063870598, \"Czech Republic\"]], [10246542, [0.0001132861689979287, \"Philippines\"]], [3591832, [0.00011326731775543504, \"Denmark\"]], [5274313, [0.00011319055335182164, \"Greece\"]], [14727077, [0.00011298651396263227, \"genus\"]], [14709489, [0.00011246839613675035, \"football (soccer)\"]], [5908108, [0.00011223456346618343, \"Hungary\"]], [3973000, [0.00011220084058220426, \"Eastern European Time\"]]]"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:71"},{"text":"%md\n#### 13.2 Wiki 50 iterations","dateUpdated":"Apr 17, 2016 11:13:01 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690973_-1630776228","id":"20160417-173450_128173397","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>13.2 Wiki 50 iterations</h4>\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:72","dateFinished":"Apr 17, 2016 11:12:59 PM","dateStarted":"Apr 17, 2016 11:12:59 PM","focus":true},{"text":"%pyspark\npage_rank_emr(\"emr_results_wiki_50iter.txt\", num_iterations=50, num_take=100)","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690973_-1630776228","id":"20160417-173450_869161622","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:73"},{"text":"%sh\naws s3 cp s3://konniamchan-w261/emr_results_wiki_50iter.txt -","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690973_-1630776228","id":"20160417-173450_1599552836","result":{"code":"SUCCESS","type":"TEXT","msg":"[[13455888, [0.0014615599818947507, \"United States\"]], [1184351, [0.0006660177937208746, \"Animal\"]], [4695850, [0.0006396773758303998, \"France\"]], [5051368, [0.0005747671983903287, \"Germany\"]], [1384888, [0.00045012322227650067, \"Arthropod\"]], [2437837, [0.00044667005175960743, \"Canada\"]], [6113490, [0.00044463224410275335, \"Insect\"]], [7902219, [0.00044387869973479304, \"List of sovereign states\"]], [13425865, [0.00043314218180867854, \"United Kingdom\"]], [6076759, [0.0004277077677814243, \"India\"]], [4196067, [0.00042341679603683755, \"England\"]], [6172466, [0.00039782604208219965, \"Iran\"]], [14112583, [0.0003854862380295691, \"World War II\"]], [10390714, [0.0003626665337431003, \"Poland\"]], [15164193, [0.0003435874530667608, \"village\"]], [3191491, [0.0003380496129215497, \"Countries of the world\"]], [6416278, [0.00032922032693063986, \"Japan\"]], [6237129, [0.00032899474585336045, \"Italy\"]], [7835160, [0.00032620175387253165, \"List of countries\"]], [1516699, [0.00032511085577414814, \"Australia\"]], [13725487, [0.0003126822772767921, \"Voivodeships of Poland\"]], [9276255, [0.00030956927415562636, \"National Register of Historic Places\"]], [7576704, [0.00030798064684122155, \"Lepidoptera\"]], [10469541, [0.00030312038150820717, \"Powiat\"]], [5154210, [0.0002975477873624792, \"Gmina\"]], [12836211, [0.00028603760472177596, \"The New York Times\"]], [7990491, [0.0002836201780318518, \"London\"]], [4198751, [0.0002690535556513176, \"English language\"]], [2797855, [0.0002640141474810625, \"China\"]], [11253108, [0.0002609847438505672, \"Russia\"]], [9386580, [0.0002576976011717259, \"New York City\"]], [3603527, [0.00025497086282428406, \"Departments of France\"]], [12074312, [0.00025102209164291455, \"Spain\"]], [3069099, [0.000248675594357363, \"Communes of France\"]], [14881689, [0.00024536414142059445, \"moth\"]], [2155467, [0.00024471986914668834, \"Brazil\"]], [1441065, [0.00023864828929658397, \"Association football\"]], [14503460, [0.0002333040343573142, \"association football\"]], [2396749, [0.00022063223478744067, \"California\"]], [3191268, [0.00021495546054195293, \"Counties of Iran\"]], [10566120, [0.00021454455864477188, \"Provinces of Iran\"]], [2614581, [0.00021120319800836942, \"Central European Time\"]], [11147327, [0.0002111871128343309, \"Romania\"]], [1637982, [0.00020703164638107024, \"Bakhsh\"]], [12430985, [0.0002033021401124227, \"Sweden\"]], [11245362, [0.00020252992613602712, \"Rural Districts of Iran\"]], [9355455, [0.00019701419939816938, \"Netherlands\"]], [10527224, [0.0001913906596198873, \"Private Use Areas\"]], [14112408, [0.00019078358675894726, \"World War I\"]], [9391762, [0.00018817152651660952, \"New York\"]], [2614578, [0.00018802207067963143, \"Central European Summer Time\"]], [8697871, [0.0001870438639840106, \"Mexico\"]], [6172167, [0.00018673257058014864, \"Iran Standard Time\"]], [981395, [0.00018522886643691978, \"AllMusic\"]], [6171937, [0.0001787491932047965, \"Iran Daylight Time\"]], [5490435, [0.00017831292468951373, \"Hangul\"]], [11582765, [0.0001733486967477644, \"Scotland\"]], [14725161, [0.00016948367866742006, \"gene\"]], [12067030, [0.00016765208016932676, \"Soviet Union\"]], [9562547, [0.00016721479992676478, \"Norway\"]], [994890, [0.00016539998300768805, \"Allmusic\"]], [9997298, [0.00016069629909546093, \"Paris\"]], [9394907, [0.00016052347835102948, \"New Zealand\"]], [13280859, [0.0001590066341095928, \"Turkey\"]], [10345830, [0.00015761805658388124, \"Plant\"]], [4978429, [0.00015527176844109047, \"Geographic Names Information System\"]], [12447593, [0.000154930203519227, \"Switzerland\"]], [8019937, [0.00015329019748237503, \"Los Angeles\"]], [11148415, [0.00014883434416031714, \"Romanize\"]], [13432150, [0.0001478569880499933, \"United States Census Bureau\"]], [4344962, [0.0001471108104027953, \"Europe\"]], [1175360, [0.0001418440693451931, \"Angiosperms\"]], [12038331, [0.0001412993002579399, \"South Africa\"]], [14565507, [0.00013906672712312432, \"census\"]], [4624519, [0.00013764660838368396, \"Flowering plant\"]], [1523975, [0.00013624635678670518, \"Austria\"]], [14981725, [0.00013489587626936366, \"protein\"]], [13328060, [0.00013474291499856756, \"U.S. state\"]], [1332806, [0.00013069327814531616, \"Argentina\"]], [10399499, [0.0001302063046224084, \"Political divisions of the United States\"]], [14963657, [0.00013003778511768026, \"population density\"]], [2578813, [0.00012841221639892973, \"Catholic Church\"]], [2826544, [0.00012820462233151183, \"Chordate\"]], [1575979, [0.00012732350080169733, \"BBC\"]], [1813634, [0.0001271535703790269, \"Belgium\"]], [2778099, [0.00012410867752457044, \"Chicago\"]], [13853369, [0.00012093630819636263, \"Washington, D.C.\"]], [9924814, [0.00012024237239930774, \"Pakistan\"]], [4568647, [0.00011577921741052627, \"Finland\"]], [12785678, [0.000114507672627749, \"The Guardian\"]], [7467127, [0.00011447345059914262, \"Latin\"]], [9742161, [0.00011430180465048886, \"Ontario\"]], [3328327, [0.00011359377948442495, \"Czech Republic\"]], [10246542, [0.0001132654264770486, \"Philippines\"]], [3591832, [0.00011323587653831479, \"Denmark\"]], [5274313, [0.000113192903617518, \"Greece\"]], [14727077, [0.00011291110380215813, \"genus\"]], [14709489, [0.00011241645994590355, \"football (soccer)\"]], [5908108, [0.00011218707481026114, \"Hungary\"]], [3973000, [0.0001121201320126125, \"Eastern European Time\"]]]"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:74"},{"text":"%pyspark\nlinks.unpersist()","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690973_-1630776228","id":"20160417-173450_1290257563","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:75"},{"text":"%md\n### 13.3 GraphX Implementation","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690973_-1630776228","id":"20160417-173450_1433872703","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>13.3 GraphX Implementation</h3>\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:76"},{"text":"import org.apache.spark._\nimport org.apache.spark.graphx._\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.graphx.lib.PageRank","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690973_-1630776228","id":"20160417-173450_338482157","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark._\nimport org.apache.spark.graphx._\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.graphx.lib.PageRank\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77"},{"text":"%pyspark\n# Convert adjacency lists into edge lists\ndef convert_graphx(data):\n    # Parse input\n    node, stripe = data.split('\\t')\n    neighbor_list = ast.literal_eval(stripe).keys()\n    # Output edge lists\n    result = []\n    for neighbor in neighbor_list:\n        result.append(\"{}\\t{}\".format(node, neighbor))\n    return result\n\nlinks = sc.textFile(\"s3://ucb-mids-mls-networks/wikipedia/all-pages-indexed-out.txt\").flatMap(convert_graphx)\nlinks.saveAsTextFile(\"s3://konniamchan-w261/PageRank-edgelist\")","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690973_-1630776228","id":"20160417-173450_1920430385","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:78"},{"text":"// Load the edges as a graph\nval graph = GraphLoader.edgeListFile(sc, \"s3://konniamchan-w261/PageRank-edgelist\").cache()","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690974_-1629621982","id":"20160417-173450_13021432","result":{"code":"SUCCESS","type":"TEXT","msg":"graph: org.apache.spark.graphx.Graph[Int,Int] = org.apache.spark.graphx.impl.GraphImpl@767afd93\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:79"},{"text":"%md\n#### 13.3: GraphX 10 iterations","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690974_-1629621982","id":"20160417-173450_1813270286","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>13.3: GraphX 10 iterations</h4>\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:80"},{"text":"// Run pagerank\nval graphx_ranks = PageRank.run(graph, 10)","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690974_-1629621982","id":"20160417-173450_517294810","result":{"code":"SUCCESS","type":"TEXT","msg":"graphx_ranks: org.apache.spark.graphx.Graph[Double,Double] = org.apache.spark.graphx.impl.GraphImpl@26de75b2\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:81"},{"text":"// Normalize ranks\nval total_rank = graphx_ranks.vertices.map(pair => pair._2).reduce((x,y) => x+y)\nval graphx_ranks_normal = graphx_ranks.vertices.map(pair => (pair._1, pair._2/total_rank) )","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690974_-1629621982","id":"20160417-173450_1466060488","result":{"code":"SUCCESS","type":"TEXT","msg":"total_rank: Double = 4253092.007387104\ngraphx_ranks_normal: org.apache.spark.rdd.RDD[(org.apache.spark.graphx.VertexId, Double)] = MapPartitionsRDD[154] at map at <console>:43\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:82"},{"text":"// Sort and output\nval result = graphx_ranks_normal.takeOrdered(100)(Ordering[Double].reverse.on(pair => pair._2))","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690974_-1629621982","id":"20160417-173450_1654027692","result":{"code":"SUCCESS","type":"TEXT","msg":"result: Array[(org.apache.spark.graphx.VertexId, Double)] = Array((13455888,0.0014557380130120411), (1184351,6.691055563898128E-4), (4695850,6.382319330019132E-4), (5051368,5.732089013598617E-4), (1384888,4.523435542225562E-4), (6113490,4.4682838382156543E-4), (2437837,4.447902534312052E-4), (7902219,4.4430007540562804E-4), (13425865,4.299358628859493E-4), (6076759,4.273262198443355E-4), (4196067,4.218083272964303E-4), (6172466,3.986312721993596E-4), (14112583,3.8283482858229346E-4), (10390714,3.624516844444432E-4), (15164193,3.4473702469335805E-4), (3191491,3.390581389379403E-4), (6416278,3.285799296044485E-4), (6237129,3.276145358788535E-4), (7835160,3.2720627351333055E-4), (1516699,3.2385165626635766E-4), (13725487,3.136045658744104E-4), (9276255,3.1020637753742726E-4), (7576704,3.09..."},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:83"},{"text":"import java.io._\n\nval file = \"emr_results_wiki_graphx_10_iter_r3cluster.txt\"\nval writer = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(file)))\nfor (x <- result) {\n  writer.write(x + \"\\n\")\n}\nwriter.close()","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690974_-1629621982","id":"20160417-173450_741620431","result":{"code":"SUCCESS","type":"TEXT","msg":"import java.io._\nfile: String = emr_results_wiki_graphx_10_iter.txt\nwriter: java.io.BufferedWriter = java.io.BufferedWriter@558416b1\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:84"},{"text":"%pyspark\nindices = sc.textFile(\"s3://ucb-mids-mls-networks/wikipedia/indices.txt\").map(format_indices).cache()","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690974_-1629621982","id":"20160417-173450_1565667279","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:86"},{"text":"%pyspark\n# Join ranks with the node names\ndef graphx_join(ranks, output_path):\n    # Join RDDs\n    graphx_ranks = sc.textFile(ranks).map(ast.literal_eval)\n    ranks_indices = graphx_ranks.join(indices).collect()\n    ranks_indices = sorted(ranks_indices, key = lambda x: x[1][0], reverse=True)\n    # Save results in S3\n    s3 = boto3.resource('s3')\n    s3.Object('konniamchan-w261', output_path).put(Body=json.dumps(ranks_indices))","dateUpdated":"Apr 17, 2016 11:15:46 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690975_-1630006730","id":"20160417-173450_22522838","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88"},{"text":"%pyspark\ngraphx_join(\"s3://konniamchan-w261/emr_results_wiki_graphx_10iter.txt\", \"emr_results_wiki_graphx_10iter_joined.txt\")","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690975_-1630006730","id":"20160417-173450_15070875","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:89"},{"text":"%sh\naws s3 cp s3://konniamchan-w261/emr_results_wiki_graphx_10iter_joined.txt -","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690975_-1630006730","id":"20160417-173450_1283824927","result":{"code":"SUCCESS","type":"TEXT","msg":"[[13455888, [0.001455738013012041, \"United States\"]], [1184351, [0.0006691055563898126, \"Animal\"]], [4695850, [0.0006382319330019134, \"France\"]], [5051368, [0.0005732089013598617, \"Germany\"]], [1384888, [0.0004523435542225562, \"Arthropod\"]], [6113490, [0.0004468283838215654, \"Insect\"]], [2437837, [0.00044479025343120514, \"Canada\"]], [7902219, [0.00044430007540562793, \"List of sovereign states\"]], [13425865, [0.0004299358628859495, \"United Kingdom\"]], [6076759, [0.0004273262198443353, \"India\"]], [4196067, [0.0004218083272964302, \"England\"]], [6172466, [0.00039863127219935966, \"Iran\"]], [14112583, [0.00038283482858229335, \"World War II\"]], [10390714, [0.00036245168444444314, \"Poland\"]], [15164193, [0.0003447370246933578, \"village\"]], [3191491, [0.00033905813893794025, \"Countries of the world\"]], [6416278, [0.00032857992960444844, \"Japan\"]], [6237129, [0.00032761453587885344, \"Italy\"]], [7835160, [0.0003272062735133304, \"List of countries\"]], [1516699, [0.00032385165626635766, \"Australia\"]], [13725487, [0.00031360456587441025, \"Voivodeships of Poland\"]], [9276255, [0.00031020637753742715, \"National Register of Historic Places\"]], [7576704, [0.0003094917501625616, \"Lepidoptera\"]], [10469541, [0.0003040569675598863, \"Powiat\"]], [5154210, [0.00029849449203262217, \"Gmina\"]], [12836211, [0.0002822450106945973, \"The New York Times\"]], [7990491, [0.0002815404308211399, \"London\"]], [4198751, [0.0002674626608704604, \"English language\"]], [2797855, [0.000262543455310975, \"China\"]], [11253108, [0.00026014913816974235, \"Russia\"]], [9386580, [0.00025540391150431687, \"New York City\"]], [3603527, [0.0002553753493792527, \"Departments of France\"]], [12074312, [0.00025017754735918947, \"Spain\"]], [3069099, [0.0002491038599665249, \"Communes of France\"]], [14881689, [0.00024657128539199975, \"moth\"]], [2155467, [0.00024462589765869444, \"Brazil\"]], [1441065, [0.00023839151443315465, \"Association football\"]], [14503460, [0.00023303693373471663, \"association football\"]], [2396749, [0.0002197462947305099, \"California\"]], [3191268, [0.00021596631999380646, \"Counties of Iran\"]], [10566120, [0.0002155507812174694, \"Provinces of Iran\"]], [11147327, [0.0002113345939323446, \"Romania\"]], [2614581, [0.00021121341467220792, \"Central European Time\"]], [1637982, [0.00020801310554959858, \"Bakhsh\"]], [11245362, [0.00020351967333384535, \"Rural Districts of Iran\"]], [12430985, [0.000202792642026531, \"Sweden\"]], [9355455, [0.00019603895087909703, \"Netherlands\"]], [10527224, [0.0001923529353749175, \"Private Use Areas\"]], [14112408, [0.00018932980087812702, \"World War I\"]], [2614578, [0.0001880576191033986, \"Central European Summer Time\"]], [6172167, [0.00018760673607347959, \"Iran Standard Time\"]], [9391762, [0.00018686643181624235, \"New York\"]], [8697871, [0.00018667940688509902, \"Mexico\"]], [981395, [0.00018496803987746606, \"AllMusic\"]], [6171937, [0.00017959921893380916, \"Iran Daylight Time\"]], [5490435, [0.00017912903082830935, \"Hangul\"]], [11582765, [0.00017233043582020195, \"Scotland\"]], [14725161, [0.00017028893197213848, \"gene\"]], [9562547, [0.0001669289674395466, \"Norway\"]], [12067030, [0.0001662857164651983, \"Soviet Union\"]], [994890, [0.00016561467350722353, \"Allmusic\"]], [9394907, [0.00016000090644853956, \"New Zealand\"]], [9997298, [0.00015959127088659597, \"Paris\"]], [13280859, [0.00015855429497435095, \"Turkey\"]], [10345830, [0.00015813270388273927, \"Plant\"]], [4978429, [0.00015512981233374522, \"Geographic Names Information System\"]], [12447593, [0.00015419732620039942, \"Switzerland\"]], [8019937, [0.00015203481727642397, \"Los Angeles\"]], [11148415, [0.00014955187023113205, \"Romanize\"]], [13432150, [0.00014720757326943808, \"United States Census Bureau\"]], [4344962, [0.00014612036233803955, \"Europe\"]], [1175360, [0.00014238527242201306, \"Angiosperms\"]], [12038331, [0.00014095353787454574, \"South Africa\"]], [14565507, [0.00013879669788875598, \"census\"]], [4624519, [0.00013805786543125324, \"Flowering plant\"]], [1523975, [0.0001356802326636273, \"Austria\"]], [14981725, [0.0001355227168609393, \"protein\"]], [13328060, [0.00013418456330044188, \"U.S. state\"]], [1332806, [0.00013043803250425406, \"Argentina\"]], [10399499, [0.00013028384103918946, \"Political divisions of the United States\"]], [14963657, [0.00012954015580780555, \"population density\"]], [2826544, [0.000128650434064744, \"Chordate\"]], [2578813, [0.00012691454970356153, \"Catholic Church\"]], [1813634, [0.00012639037450556652, \"Belgium\"]], [1575979, [0.00012599004435876398, \"BBC\"]], [2778099, [0.00012304913128906715, \"Chicago\"]], [9924814, [0.00012001389689060302, \"Pakistan\"]], [13853369, [0.00011943015904206405, \"Washington, D.C.\"]], [4568647, [0.00011545922908868351, \"Finland\"]], [9742161, [0.00011373160332467578, \"Ontario\"]], [14727077, [0.0001133418192164662, \"genus\"]], [3328327, [0.00011330440763703959, \"Czech Republic\"]], [12785678, [0.00011324008681459615, \"The Guardian\"]], [7467127, [0.00011310220147266328, \"Latin\"]], [10246542, [0.00011284638230586798, \"Philippines\"]], [3591832, [0.00011275763136270924, \"Denmark\"]], [5274313, [0.00011266269447292228, \"Greece\"]], [3973000, [0.00011235417773778346, \"Eastern European Time\"]], [14709489, [0.0001123479125615619, \"football (soccer)\"]], [15070394, [0.00011228447655350397, \"species\"]]]"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:90"},{"text":"%md\n#### 13.3 GraphX: 50 iterations","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690975_-1630006730","id":"20160417-173450_2592937","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>13.3 GraphX: 50 iterations</h4>\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:91"},{"text":"// Run pagerank\nval graphx_ranks = PageRank.run(graph, 50)\n// Normalize ranks\nval total_rank = graphx_ranks.vertices.map(pair => pair._2).reduce((x,y) => x+y)\nval graphx_ranks_normal = graphx_ranks.vertices.map(pair => (pair._1, pair._2/total_rank) )\n// Sort and output\nval result = graphx_ranks_normal.takeOrdered(100)(Ordering[Double].reverse.on(pair => pair._2))","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690975_-1630006730","id":"20160417-173450_1016238688","result":{"code":"SUCCESS","type":"TEXT","msg":"graphx_ranks: org.apache.spark.graphx.Graph[Double,Double] = org.apache.spark.graphx.impl.GraphImpl@54e5707d\ntotal_rank: Double = 4274546.444762159\ngraphx_ranks_normal: org.apache.spark.rdd.RDD[(org.apache.spark.graphx.VertexId, Double)] = MapPartitionsRDD[775] at map at <console>:43\nresult: Array[(org.apache.spark.graphx.VertexId, Double)] = Array((13455888,0.0014615599819318402), (1184351,6.660177940416522E-4), (4695850,6.396773759063147E-4), (5051368,5.747671984504287E-4), (1384888,4.501232225122851E-4), (2437837,4.4667005176375396E-4), (6113490,4.446322443336369E-4), (7902219,4.4387869981374567E-4), (13425865,4.3314218174318194E-4), (6076759,4.277077678674366E-4), (4196067,4.2341679606080975E-4), (6172466,3.9782604219812845E-4), (14112583,3.854862379829447E-4), (10390714,3.6266653380361723E-4), (15164193,3.4358745320868853E-4), (3191491,3.3804961305056305E-4), (6416278,3.2922032697437886E-4), (6237129,3.289947458610153E-4), (7835160,3.2620175400650104E-4), (1516699,3.251108557644901E-4), (13725487,3.126822773847866E-4), (9276255,3.0956927427494265E-4), (7576704,..."},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:92"},{"text":"import java.io._\nval file = \"emr_results_wiki_graphx_50iter.txt\"\nval writer = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(file)))\nfor (x <- result) {\n  writer.write(x + \"\\n\")\n}\nwriter.close()","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690975_-1630006730","id":"20160417-173450_325904967","result":{"code":"SUCCESS","type":"TEXT","msg":"import java.io._\nfile: String = emr_results_wiki_graphx_50iter.txt\nwriter: java.io.BufferedWriter = java.io.BufferedWriter@38fdd4ac\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:93"},{"text":"%sh\naws s3 cp \"emr_results_wiki_graphx_50iter.txt\" s3://konniamchan-w261/","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690975_-1630006730","id":"20160417-173450_1944186960","result":{"code":"SUCCESS","type":"TEXT","msg":"upload: ./emr_results_wiki_graphx_50iter.txt to s3://konniamchan-w261/emr_results_wiki_graphx_50iter.txt\n"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:94"},{"text":"%pyspark\ngraphx_join(\"s3://konniamchan-w261/emr_results_wiki_graphx_50iter.txt\", \"emr_results_wiki_graphx_50iter_joined.txt\")","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690976_-1644242440","id":"20160417-173450_1342145629","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:95"},{"text":"%sh\naws s3 cp s3://konniamchan-w261/emr_results_wiki_graphx_50iter_joined.txt -","dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690976_-1644242440","id":"20160417-173450_1733693008","result":{"code":"SUCCESS","type":"TEXT","msg":"[[13455888, [0.0014615599819318402, \"United States\"]], [1184351, [0.0006660177940416522, \"Animal\"]], [4695850, [0.0006396773759063147, \"France\"]], [5051368, [0.0005747671984504287, \"Germany\"]], [1384888, [0.0004501232225122851, \"Arthropod\"]], [2437837, [0.00044667005176375396, \"Canada\"]], [6113490, [0.0004446322443336369, \"Insect\"]], [7902219, [0.00044387869981374567, \"List of sovereign states\"]], [13425865, [0.00043314218174318194, \"United Kingdom\"]], [6076759, [0.0004277077678674366, \"India\"]], [4196067, [0.00042341679606080975, \"England\"]], [6172466, [0.00039782604219812845, \"Iran\"]], [14112583, [0.0003854862379829447, \"World War II\"]], [10390714, [0.00036266653380361723, \"Poland\"]], [15164193, [0.00034358745320868853, \"village\"]], [3191491, [0.00033804961305056305, \"Countries of the world\"]], [6416278, [0.00032922032697437886, \"Japan\"]], [6237129, [0.0003289947458610153, \"Italy\"]], [7835160, [0.00032620175400650104, \"List of countries\"]], [1516699, [0.0003251108557644901, \"Australia\"]], [13725487, [0.0003126822773847866, \"Voivodeships of Poland\"]], [9276255, [0.00030956927427494265, \"National Register of Historic Places\"]], [7576704, [0.0003079806470035847, \"Lepidoptera\"]], [10469541, [0.0003031203816167943, \"Powiat\"]], [5154210, [0.0002975477874711376, \"Gmina\"]], [12836211, [0.00028603760459616415, \"The New York Times\"]], [7990491, [0.0002836201779951804, \"London\"]], [4198751, [0.00026905355563185167, \"English language\"]], [2797855, [0.00026401414746584593, \"China\"]], [11253108, [0.00026098474386971346, \"Russia\"]], [9386580, [0.000257697601116067, \"New York City\"]], [3603527, [0.0002549708629038769, \"Departments of France\"]], [12074312, [0.0002510220916580598, \"Spain\"]], [3069099, [0.0002486755944376828, \"Communes of France\"]], [14881689, [0.00024536414155052123, \"moth\"]], [2155467, [0.0002447198691952866, \"Brazil\"]], [1441065, [0.00023864828933918054, \"Association football\"]], [14503460, [0.00023330403439988256, \"association football\"]], [2396749, [0.00022063223479429274, \"California\"]], [3191268, [0.00021495546064368543, \"Counties of Iran\"]], [10566120, [0.0002145445587461694, \"Provinces of Iran\"]], [2614581, [0.0002112031980526359, \"Central European Time\"]], [11147327, [0.00021118711288606266, \"Romania\"]], [1637982, [0.0002070316464809762, \"Bakhsh\"]], [12430985, [0.00020330214013080508, \"Sweden\"]], [11245362, [0.00020252992623867233, \"Rural Districts of Iran\"]], [9355455, [0.00019701419939340616, \"Netherlands\"]], [10527224, [0.00019139065973232953, \"Private Use Areas\"]], [14112408, [0.00019078358672900257, \"World War I\"]], [9391762, [0.00018817152649487547, \"New York\"]], [2614578, [0.00018802207071992691, \"Central European Summer Time\"]], [8697871, [0.00018704386400623745, \"Mexico\"]], [6172167, [0.00018673257067054354, \"Iran Standard Time\"]], [981395, [0.00018522886644697275, \"AllMusic\"]], [6171937, [0.00017874919329442953, \"Iran Daylight Time\"]], [5490435, [0.00017831292478868616, \"Hangul\"]], [11582765, [0.00017334869673844402, \"Scotland\"]], [14725161, [0.00016948367874702327, \"gene\"]], [12067030, [0.00016765208013729848, \"Soviet Union\"]], [9562547, [0.00016721479994849997, \"Norway\"]], [994890, [0.00016539998305853474, \"Allmusic\"]], [9997298, [0.0001606962990771279, \"Paris\"]], [9394907, [0.00016052347836169784, \"New Zealand\"]], [13280859, [0.00015900663412349194, \"Turkey\"]], [10345830, [0.00015761805663195135, \"Plant\"]], [4978429, [0.00015527176846678547, \"Geographic Names Information System\"]], [12447593, [0.00015493020351598513, \"Switzerland\"]], [8019937, [0.00015329019745101712, \"Los Angeles\"]], [11148415, [0.00014883434424029575, \"Romanize\"]], [13432150, [0.00014785698804186507, \"United States Census Bureau\"]], [4344962, [0.00014711081038309748, \"Europe\"]], [1175360, [0.00014184406940566854, \"Angiosperms\"]], [12038331, [0.0001412993002731632, \"South Africa\"]], [14565507, [0.00013906672713715444, \"census\"]], [4624519, [0.0001376466084144871, \"Flowering plant\"]], [1523975, [0.000136246356789382, \"Austria\"]], [14981725, [0.0001348958763317732, \"protein\"]], [13328060, [0.00013474291499747924, \"U.S. state\"]], [1332806, [0.00013069327815990925, \"Argentina\"]], [10399499, [0.00013020630465632933, \"Political divisions of the United States\"]], [14963657, [0.00013003778511744784, \"population density\"]], [2578813, [0.00012841221634952966, \"Catholic Church\"]], [2826544, [0.00012820462237288742, \"Chordate\"]], [1575979, [0.00012732350076292772, \"BBC\"]], [1813634, [0.0001271535703694687, \"Belgium\"]], [2778099, [0.00012410867749741613, \"Chicago\"]], [13853369, [0.00012093630814915258, \"Washington, D.C.\"]], [9924814, [0.00012024237241725794, \"Pakistan\"]], [4568647, [0.00011577921741937876, \"Finland\"]], [12785678, [0.00011450767259016701, \"The Guardian\"]], [7467127, [0.00011447345055530333, \"Latin\"]], [9742161, [0.0001143018046456811, \"Ontario\"]], [3328327, [0.0001135937794906745, \"Czech Republic\"]], [10246542, [0.00011326542648215697, \"Philippines\"]], [3591832, [0.00011323587653913932, \"Denmark\"]], [5274313, [0.00011319290361786968, \"Greece\"]], [14727077, [0.00011291110384987171, \"genus\"]], [14709489, [0.0001124164599679749, \"football (soccer)\"]], [5908108, [0.00011218707482019654, \"Hungary\"]], [3973000, [0.00011212013205027737, \"Eastern European Time\"]]]"},"dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:96"},{"dateUpdated":"Apr 17, 2016 5:34:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460939690976_-1644242440","id":"20160417-173450_194966254","dateCreated":"Apr 17, 2016 5:34:50 PM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:100"}],"name":"Konniam-Dev-Week13-Zeppelin","id":"2BH1NCD2F","angularObjects":{"2BFH116DG":[],"2BFXNPBUV":[],"2BH1CJQ1Y":[],"2BECGRCTW":[],"2BFFRVDTS":[],"2BGD3TQD1":[],"2BEQGJJ7T":[],"2BF1K4XMY":[],"2BH81Q5FU":[],"2BEMNVYA1":[],"2BG777FAS":[],"2BFJVM6A5":[],"2BHDST5JV":[],"2BHPR5MT4":[]},"config":{"looknfeel":"default"},"info":{}}